{% extends 'website/base.html' %}

{% block head_css %}
    {{ super() }}
    <!-- The required Stripe lib -->
    <script type="text/javascript" src="https://js.stripe.com/v3/"></script>
{% endblock %}

{% block page_body %}

  <form action="/payment/checkout" method="post" id="form_checkout">
    <input type="hidden" name="cart_checkout" id="checkout_info" >
    <script
        src="https://checkout.stripe.com/checkout.js" class="stripe-button"
        data-key="{{ public_key }}"
        data-name="Company Name"
        data-image="https://stripe.com/img/documentation/checkout/marketplace.png"
        data-description="A description of the product or service being purchased"
        data-amount="999"
        data-shipping-address="true"
        data-zip-code="true"
        data-allow-remember-me="true"
        data-panel-label="Pay"
        data-label="Checkout"
        data-locale="auto">
  </script>
  </form>

{% endblock %}

{% block tail_js %}
    {{ super() }}
    <script src="{{ site_static.url(filename='site/js/payment.js') }}" type="text/javascript"></script>
    <script type="text/javascript">
        var stripe = Stripe("{{public_key}}");
        
        {% if redirect %}
        stripe.redirectToCheckout({
          // Make the id field from the Checkout Session creation API response
          // available to this file, so you can provide it as parameter here
          // instead of the {{CHECKOUT_SESSION_ID}} placeholder.
          sessionId: '{{CHECKOUT_SESSION_ID}}'
        }).then(function (result) {
          // If `redirectToCheckout` fails due to a browser or network
          // error, display the localized error message to your customer
          // using `result.error.message`.
        });
        {% endif %}


    </script>

{% endblock %}